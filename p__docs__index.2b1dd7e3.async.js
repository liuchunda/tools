"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[287],{18661:function(Pe,G,a){a.r(G),a.d(G,{default:function(){return De}});var x=a(17384),q=a.n(x),_=a(60430),U=a.n(_),ee=a(53939),m=a.n(ee),re=a(83134),C=a.n(re),ae=a(34827),E=a.n(ae),y=a(82702),ne=a(38964),se=a(61507),te=a(78058),I=a(45925),H=a(48238),L=a(55963),ue=a(66099),S=a(40670),le=a(25592),ie=a(35452),O=a(22745),Q=a(4512),de=a(61383),ce=a(76109),fe=a(12583),h={pdfItemWrapper:"pdfItemWrapper___acdCd",pdfItemCard:"pdfItemCard___cJbtf",deleteButton:"deleteButton___ekUBv",pdfItemContent:"pdfItemContent___mF2DW",pdfThumbnail:"pdfThumbnail___iMIq8",pdfPlaceholder:"pdfPlaceholder___FuqaL",pdfIcon:"pdfIcon___IQPpR",pdfInfo:"pdfInfo___YGiSU",pdfName:"pdfName___PuqqQ",pdfPages:"pdfPages___D3Duv"},r=a(97616),oe=function(b){var g=b.item,p=b.index,Z=b.moveItem,$=b.removeItem,A=(0,de.c)({type:"pdf-item",item:{index:p},collect:function(D){return{isDragging:D.isDragging()}}}),w=E()(A,2),F=w[0].isDragging,B=w[1],z=(0,ce.L)({accept:"pdf-item",hover:function(D){D.index!==p&&(Z(D.index,p),D.index=p)}}),k=E()(z,2),W=k[1],M=F?.5:1;return(0,r.jsx)("div",{ref:function(D){return B(W(D))},style:{opacity:M},className:h.pdfItemWrapper,children:(0,r.jsxs)(L.Z,{className:h.pdfItemCard,hoverable:!0,children:[(0,r.jsx)(S.ZP,{type:"text",danger:!0,size:"small",className:h.deleteButton,icon:(0,r.jsx)(fe.Z,{}),onClick:function(){return $(g.id)}},"delete"),(0,r.jsxs)("div",{className:h.pdfItemContent,children:[(0,r.jsx)("div",{className:h.pdfThumbnail,children:g.thumbnail?(0,r.jsx)("img",{src:g.thumbnail,alt:g.name}):(0,r.jsx)("div",{className:h.pdfPlaceholder,children:(0,r.jsx)("div",{className:h.pdfIcon,children:"PDF"})})}),(0,r.jsx)("div",{className:h.pdfInfo,children:(0,r.jsx)("div",{className:h.pdfName,title:g.name,children:g.name})})]})]})})},me=oe;Q.Tu.workerSrc="/pdf.worker.min.mjs";var pe=te.Z.Title,ve=function(){var b=(0,y.useState)([]),g=E()(b,2),p=g[0],Z=g[1],$=(0,y.useState)(!1),A=E()($,2),w=A[0],F=A[1],B=(0,y.useRef)(new Set),z=function(){var l=C()(m()().mark(function s(t){var i,u,P,n,c,o,v,f,d;return m()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.arrayBuffer();case 3:return i=e.sent,u=Q.Me({data:i}),e.next=7,u.promise;case 7:return P=e.sent,e.next=10,P.getPage(1);case 10:if(n=e.sent,c=1.5,o=n.getViewport({scale:c}),v=document.createElement("canvas"),f=v.getContext("2d"),f){e.next=17;break}return e.abrupt("return","");case 17:return v.height=o.height,v.width=o.width,d={canvasContext:f,viewport:o,canvas:v},e.next=22,n.render(d).promise;case 22:return e.abrupt("return",v.toDataURL("image/png"));case 25:return e.prev=25,e.t0=e.catch(0),console.error("\u751F\u6210\u7F29\u7565\u56FE\u5931\u8D25:",e.t0),e.abrupt("return","");case 29:case"end":return e.stop()}},s,null,[[0,25]])}));return function(t){return l.apply(this,arguments)}}(),k=function(){var l=C()(m()().mark(function s(t){var i,u;return m()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,t.arrayBuffer();case 3:return i=n.sent,n.next=6,O.PDFDocument.load(i);case 6:return u=n.sent,n.abrupt("return",u.getPageCount());case 10:return n.prev=10,n.t0=n.catch(0),console.error("\u8BFB\u53D6 PDF \u5931\u8D25:",n.t0),n.abrupt("return",0);case 14:case"end":return n.stop()}},s,null,[[0,10]])}));return function(t){return l.apply(this,arguments)}}(),W=(0,y.useCallback)(function(){var l=C()(m()().mark(function s(t){var i,u;return m()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(i=t.fileList,u=[],i.forEach(function(c){if(c.status==="done"||c.originFileObj){var o=c.originFileObj||c;o&&o.type==="application/pdf"&&u.push(o)}}),u.length>0){F(!0);try{Z(function(c){var o=new Set(c.map(function(f){return"".concat(f.name,"-").concat(f.file.size)})),v=u.filter(function(f){var d="".concat(f.name,"-").concat(f.size);return o.has(d)||B.current.has(d)?!1:(B.current.add(d),!0)});return v.length===0?(F(!1),c):(C()(m()().mark(function f(){var d;return m()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.all(v.map(function(){var T=C()(m()().mark(function V(R){var Y,X;return m()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.next=2,k(R);case 2:return Y=j.sent,j.next=5,z(R);case 5:return X=j.sent,j.abrupt("return",{id:"".concat(Date.now(),"-").concat(Math.random()),file:R,thumbnail:X,name:R.name,pages:Y});case 7:case"end":return j.stop()}},V)}));return function(V){return T.apply(this,arguments)}}()));case 3:d=e.sent,Z(function(T){return[].concat(U()(T),U()(d))}),I.ZP.success("\u6210\u529F\u6DFB\u52A0 ".concat(d.length," \u4E2A PDF \u6587\u4EF6")),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),I.ZP.error("\u5904\u7406 PDF \u6587\u4EF6\u5931\u8D25"),console.error(e.t0);case 12:return e.prev=12,F(!1),e.finish(12);case 15:case"end":return e.stop()}},f,null,[[0,8,12,15]])}))(),c)})}catch(c){I.ZP.error("\u5904\u7406 PDF \u6587\u4EF6\u5931\u8D25"),console.error(c),F(!1)}}case 4:case"end":return n.stop()}},s)}));return function(s){return l.apply(this,arguments)}}(),[]),M=(0,y.useCallback)(function(l,s){Z(function(t){var i=U()(t),u=i.splice(l,1),P=E()(u,1),n=P[0];return i.splice(s,0,n),i})},[]),N=(0,y.useCallback)(function(l){Z(function(s){var t=s.find(function(u){return u.id===l});if(t){var i="".concat(t.name,"-").concat(t.file.size);B.current.delete(i)}return s.filter(function(u){return u.id!==l})}),I.ZP.success("\u5DF2\u5220\u9664")},[]),D=(0,y.useCallback)(C()(m()().mark(function l(){var s,t,i,u,P,n,c,o,v,f,d;return m()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(p.length!==0){e.next=3;break}return I.ZP.warning("\u8BF7\u5148\u4E0A\u4F20 PDF \u6587\u4EF6"),e.abrupt("return");case 3:return F(!0),e.prev=4,e.next=7,O.PDFDocument.create();case 7:s=e.sent,t=q()(p),e.prev=9,t.s();case 11:if((i=t.n()).done){e.next=25;break}return u=i.value,e.next=15,u.file.arrayBuffer();case 15:return P=e.sent,e.next=18,O.PDFDocument.load(P);case 18:return n=e.sent,e.next=21,s.copyPages(n,n.getPageIndices());case 21:c=e.sent,c.forEach(function(T){s.addPage(T)});case 23:e.next=11;break;case 25:e.next=30;break;case 27:e.prev=27,e.t0=e.catch(9),t.e(e.t0);case 30:return e.prev=30,t.f(),e.finish(30);case 33:return e.next=35,s.save();case 35:o=e.sent,v=new Blob([o.buffer],{type:"application/pdf"}),f=URL.createObjectURL(v),d=document.createElement("a"),d.href=f,d.download="\u5408\u5E76\u7684PDF_".concat(new Date().getTime(),".pdf"),document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(f),I.ZP.success("PDF \u5408\u5E76\u6210\u529F\uFF01"),e.next=52;break;case 48:e.prev=48,e.t1=e.catch(4),I.ZP.error("\u5408\u5E76 PDF \u5931\u8D25"),console.error(e.t1);case 52:return e.prev=52,F(!1),e.finish(52);case 55:case"end":return e.stop()}},l,null,[[4,48,52,55],[9,27,30,33]])})),[p]);return(0,r.jsx)(ne.W,{backend:se.PD,children:(0,r.jsxs)("div",{className:"pdf-combine-container",children:[(0,r.jsx)(pe,{level:2,children:"PDF \u5408\u5E76\u5DE5\u5177"}),(0,r.jsxs)(H.Z,{direction:"vertical",size:"large",style:{width:"100%"},children:[(0,r.jsx)(L.Z,{children:(0,r.jsx)(ue.Z,{multiple:!0,accept:".pdf",fileList:[],beforeUpload:function(){return!1},onChange:W,showUploadList:!1,children:(0,r.jsx)(S.ZP,{icon:(0,r.jsx)(le.Z,{}),loading:w,children:"\u4E0A\u4F20 PDF \u6587\u4EF6\uFF08\u53EF\u591A\u9009\uFF09"})})}),p.length>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(L.Z,{children:(0,r.jsx)("div",{className:"pdf-list",children:p.map(function(l,s){return(0,r.jsx)(me,{item:l,index:s,moveItem:M,removeItem:N},l.id)})})}),(0,r.jsx)(L.Z,{children:(0,r.jsxs)(H.Z,{children:[(0,r.jsx)(S.ZP,{type:"primary",icon:(0,r.jsx)(ie.Z,{}),onClick:D,loading:w,size:"large",children:"\u5408\u5E76\u5E76\u4E0B\u8F7D PDF"}),(0,r.jsxs)("div",{className:"merge-info",children:["\u5171 ",p.length," \u4E2A\u6587\u4EF6\uFF0C\u603B\u8BA1 ",p.reduce(function(l,s){return l+s.pages},0)," \u9875"]})]})})]})]})]})})},he=ve,ge=function(){return(0,r.jsx)("div",{children:(0,r.jsx)(he,{})})},De=ge}}]);
